---
title: "Appendix part 2"
author: "Cole J. Harvey (Oklahoma State University)"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
    bookdown::pdf_document2: default
linkcolor: blue
bibliography: C:/Users/colej/Documents/Research projects/bib_ch.bib
#biblio-style: "apalike"
fontsize: 12pt
link-citations: yes
toc: false
csl: C:/Users/colej/Documents/Research projects/ji_manipulation_protest/american-journal-of-political-science.csl
header-includes: \usepackage{booktabs}
---
```{r setup, include = FALSE}
library(tidyverse)
library(countrycode)
library(readxl)
library(vdemdata)
library(lme4)
library(interplot)
library(lubridate)
library(summarytools)
library(stargazer)
library(ggeffects)
library(glmmTMB)
library(modelsummary)
library(huxtable)
library(simPH)
library(survival)

nelda_massmob <- read.csv(here::here("Data", "nelda_massmob_all.csv")) #nelda_complete.csv for only elex-related
nelda2.sub <- read.csv(here::here("Data", "nelda2_sub_2023-05-22.csv"))

##Bringing nelda2.sub variables over to massmob dataset
nelda2_select <- nelda2.sub %>% dplyr::select(NeldaID, regime_age, v2elirreg.inv.lag)
nelda_massmob <- nelda_massmob %>% rename(NeldaID = electionid)

nelda_massmob <- nelda_massmob %>% left_join(nelda2_select, by = "NeldaID")



nelda_massmob <- nelda_massmob %>% mutate(legit_no_proc = (v2exl_legitperf + v2exl_legitlead + v2exl_legitideol))
nelda_massmob <- nelda_massmob %>% mutate(legit_total = (v2exl_legitperf + v2exl_legitlead + v2exl_legitideol + v2exl_legitratio))



##Naming nelda variables

nelda_massmob <- nelda_massmob %>% rename(boycott = nelda14)
nelda_massmob <- nelda_massmob %>% mutate(boycott = ifelse(boycott == "yes", 1, ifelse(boycott == "no", 0,
                                                                                 NA)))

##Creating economic crisis variable

nelda_massmob <- nelda_massmob %>% mutate(econ.crisis = ifelse(is.na(e_miinflat) == T | is.na(gdpgro.1lag) == T, NA, ifelse(e_miinflat > 15 | gdpgro.1lag <= -0.012, 1, 0)))
nelda_massmob <- nelda_massmob %>% mutate(econ.crisis = as.factor(econ.crisis))

nelda_massmob <- nelda_massmob %>% mutate(gdp.crisis = ifelse(is.na(gdpgro.1lag) == T, NA, ifelse(gdpgro.1lag <= -0.012, 1, 0)))
nelda_massmob <- nelda_massmob %>% mutate(inflat.crisis = ifelse(is.na(e_miinflat) == T, NA, ifelse(e_miinflat > 15, 1, 0)))

nelda_massmob <- nelda_massmob %>% mutate(grievance.index = ifelse(is.na(e_migdppcln) == T, NA, e_migdppcln*v2xeg_eqdr))

##Removing cases before 1990, when ECAV starts
nelda_massmob <- nelda_massmob %>% filter(year >= 1990)

## Removing cases where inc. loses
#nelda_massmob <- nelda_massmob %>% filter(inc.lose == 0)

##Nelda crisis as a factor

nelda_massmob <- nelda_massmob %>% mutate(econ.crisis.nelda.1lag = as.factor(econ.crisis.nelda.1lag))

##Intmon as a factor
nelda_massmob <- nelda_massmob %>% mutate(v2elintmon = as.factor(v2elintmon))

##Presidential as a facotr
nelda_massmob <- nelda_massmob %>% mutate(presidential = as.factor(presidential))


nelda_massmob <- nelda_massmob %>% mutate(electoral.dem = ifelse(v2x_regime == 2, 1, 0))

#Square of physint

nelda_massmob <- nelda_massmob %>% mutate(physintlag.sq = physinteg.1lag^2)


#Crisis as factor

nelda_massmob <- nelda_massmob %>% mutate(econ.crisis.nelda.1lag = factor(econ.crisis.nelda.1lag))

#Margins with updates

nelda_massmob <- nelda_massmob %>% mutate(winner.share.upd = ifelse(types == "Executive", v2elvotlrg_amend/100, v2ellovtlg_amend/100))

#Successful protest = new elections or new incumbent

nelda_massmob <- nelda_massmob %>% mutate(protest.success = ifelse(inc.replaced.prot == 1 | elections.cancel.prot, 1, 0))

#Protest cases only

#protest.cases <- nelda_massmob %>% filter(any.ecav.protest == 1)


# Replacing NA with 0 for term limits variable in known parliamentary countries in legislative elections

nelda_massmob <- nelda_massmob %>% mutate(inc.termlimit.num = ifelse(is.na(inc.termlimit.num) == T & v2ex_elechog == 0, 0, inc.termlimit.num))

## Changing participants from numeric category to text
#nelda_massmob <- nelda_massmob %>% mutate(median.participants = round(median.participants))
#nelda_massmob <- nelda_massmob %>% mutate(particpants_categorical = ifelse(is.na(median.participants)==T, NA, ifelse(median.participants == 1, "Less than 10",
#                     ifelse(2, "10 to 99", ifelse(3, "100 to 999",
#                                                  ifelse(4, "1000 to 9,999", ifelse(5, "Greater than 10,000", NA)))))))
#nelda_massmob <- nelda_massmob %>% mutate(particpants_categorical = as.factor(particpants_categorical))

## Median particiants (MM) as factor

nelda_massmob <- nelda_massmob %>% mutate(median.participants.mm.post = as.factor(median.participants.mm.post))

## Inverting the vote buying measure so it is not reverse coded

nelda_massmob <- nelda_massmob %>% mutate(v2elvotbuy_inv = -1*v2elvotbuy)


```


# Robustness check using Mass Mobilization dataset

Not including duration or size data since MassMob data includes all protest, not just election focused and has less reliable size data. Will still use number.


```{r}
m1 <- lmer(v2elirreg.inv ~ jucon.1lag + legcon.1lag + gdpgro.1lag +  osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag   +  presidential + libdem.1lag + urban.pct + rentierstate + taxstate + n.events.massmob.pre +  physinteg.1lag + physintlag.sq    + unscheduled_election + regime_age + (1 | stateid), data = nelda_massmob) 

#summary(m1)

m1b <- lmer(v2elirreg.inv ~ v2elirreg.inv.lag + jucon.1lag + legcon.1lag  + gdpgro.1lag +  osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag   + presidential   +  libdem.1lag + urban.pct + rentierstate + taxstate + n.events.massmob.pre +  physinteg.1lag + physintlag.sq  + unscheduled_election + regime_age+ (1 | stateid), data = nelda_massmob) 
summary(m1b)
```


```{r}
nelda_massmob <- nelda_massmob %>% mutate(n.events.massmob.pre_any = ifelse(n.events.massmob.pre > 0, 1, 0)) #Including the raw value of this variable becomes almost perfectly predictive of the zero-inflation portion of the model

model.n.base2.hurd.mm <- glmmTMB::glmmTMB(n.events.massmob.post ~  jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag + pubseccorrup.lag + osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +    winner.share.upd*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre + unscheduled_election + regime_age + inc.lose,
                                          zi = ~  jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag + pubseccorrup.lag + osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +    winner.share.upd*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre_any + unscheduled_election + regime_age + inc.lose,
                                          family= nbinom2,
                                          data = nelda_massmob)
summary(model.n.base2.hurd.mm)


model.n.griev.hurd.mm <- glmmTMB::glmmTMB(n.events.massmob.post ~ jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag +  osorg.1lag +  natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   gdpgro.1lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre + unscheduled_election + regime_age+ inc.lose,
                                ziformula=~  jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag + pubseccorrup.lag + osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +    winner.share.upd*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre_any + unscheduled_election + regime_age + inc.lose,
                                data = nelda_massmob,
                                family=truncated_nbinom2)
summary(model.n.griev.hurd.mm)



```

```{r zero-model-table, echo=FALSE, results='asis', warning=FALSE, message=FALSE}

models_t1 <- list()
models_t1[['Model 4']] <- model.n.base2.hurd.mm
models_t1[['Model 5']] <- model.n.griev.hurd.mm
#models_t1[['Model 5']] <- m_duration_count
#models_t1[['Model 6']] <- model.d.base2.hurd
#models_t1[['Model 7']] <- model.d.griev.hurd


t1a <- huxreg(models_t1, tidy_args = c("component" = "zi"), borders = 0, number_format = 2, omit_coefs = c("rentierstate1", "taxstate1", "n.events.pre", "unscheduled_election1", "inc.lose1", "v2elirreg.inv:winner.share.upd", "gdpgro.1lag:v2elirreg.inv"), statistics = character(0)) %>% set_caption("Table 3: Zero-inflated models of protest initiation")


theme_compact(t1a, header_rows = TRUE, header_cols = FALSE)


t1b <- huxreg(models_t1, tidy_args = c("component" = "zi"), borders = 0, number_format = 2, omit_coefs = c("(Intercept)", "jucon.1lag" , "legcon.1lag" , "gdpgro.1lag" , "altinf.1lag" , "pubseccorrup.lag" , "osorg.1lag" , "econ.crisis.nelda.1lag1" , "natlpartyorg.lag" , "v2elirreg.inv" , "pubseccorrup.lag"   , "presidential1" , "inc.termlimit.num1"  ,  "physinteg.1lag" , "physintlag.sq" , "urban.pct")) %>% set_caption("Table 3 cont.: Zero-inflated models of protest initiation")


theme_compact(t1b, header_rows = TRUE, header_cols = FALSE)




models_t2 <- list()
models_t2[['Model 4']] <- model.n.base2.hurd.mm
models_t2[['Model 5']] <- model.n.griev.hurd.mm



t2a <- huxreg(models_t2, tidy_args = c("component" = "cond"), borders = 0, number_format = 2, stars = c(`***` = 0.001, `**` = 0.01, `*` = 0.05, `+` = .1), omit_coefs = c("rentierstate1", "taxstate1", "n.events.pre", "unscheduled_election1", "inc.lose1", "v2elirreg.inv:winner.share.upd", "gdpgro.1lag:v2elirreg.inv"), statistics = character(0)) %>% set_caption("Table 4: Negative binomial models of number of protests")


theme_compact(t2a, header_rows = TRUE, header_cols = FALSE)


t2b <- huxreg(models_t2, tidy_args = c("component" = "cond"), borders = 0, number_format = 2, stars = c(`***` = 0.001, `**` = 0.01, `*` = 0.05, `+` = .1), omit_coefs = c("(Intercept)", "jucon.1lag" , "legcon.1lag" , "gdpgro.1lag" , "altinf.1lag" , "pubseccorrup.lag" , "osorg.1lag" , "econ.crisis.nelda.1lag1" , "natlpartyorg.lag" , "v2elirreg.inv" , "pubseccorrup.lag"   , "presidential1" , "inc.termlimit.num1"  ,  "physinteg.1lag" , "physintlag.sq" , "urban.pct")) %>% set_caption("Table 4 cont.: Negative binomial models of number of protests")


theme_compact(t2b, header_rows = TRUE, header_cols = FALSE)


#modelsummary::modelsummary(models, shape = term + estimate + component ~ model, coef_omit = "count", gof_omit = "R2", stars = T, longtable=T,  title = 'Binary portion of hurdle models of post-election protest', coef_rename = 
#               c("zero_(Intercept)" = "Intercept", "zero_jucon.1lag" = "Judical independence (lag)", "zero_legcon.1lag" = "Leg. constraints (lag)", 
#                 "zero_gdpgro.1lag" = "GDP growth rate (lag)", "zero_altinf.1lag" = "Alternative info. (lag)", 
#                 "zero_osorg.1lag" = "Civil soc. openness (lag)", "zero_econ.crisis.nelda.1lag1" = "Economic crisis", 
#                 "zero_natlpartyorg.lag" = "National party organization (lag)", "zero_presidential1" = "Presidential election",
#                 "zero_inc.termlimit.num" = "Incumbent term-limited",  
#                 "zero_urban.pct" = "Urbanization", "zero_rentierstate" = "Rentier state", "zero_taxstate" = "Tax state",
#                 "zero_n.events.pre" = "Number of pre-election protests", "zero_pubseccorrup.lag" = "Public sector corruption (lag)", "zero_v2elirreg.inv" = "Election fraud",
#                 "zero_physinteg.1lag" = "Physical integrity (lag)", "zero_physintlag.sq" = "Physical integrity (lag), squared", "zero_winner.share.upd" = "Incumbent vote-share", "v2elirreg.inv" = "Election fraud", "zero_unscheduled_election" = "Off-schedule election")) # %>%
#  add_header_above(c(" " = 1, "Protest quantity" = 3, "Maximum protest size" = 3))


```


Figures \@ref(fig:n-protests-margin-max), \@ref(fig:n-protests-crisis-max), and \@ref(fig:n-protests-corrupt-max) illustrate the marginal effects of extreme values for election fraud on the expected number of post-election protests, based on Models 4 - 6 in the main text. They demonstrate that there is no significant relationship between the severity of fraud and the size of post-election protest waves for any of the moderator variables\textemdash incumbent vote-share, economic crisis, or public sector corruption.


```{r, include=FALSE}
model.n.base2.hurd.mm <- hurdle(n.events.massmob.post ~  jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag + pubseccorrup.lag + osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +    winner.share.upd*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre |  jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag + pubseccorrup.lag + osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +    winner.share.upd*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre, data = nelda_massmob %>% filter(gdpgro.1lag < 1), dist = "negbin")
summary(model.n.base2.hurd.mm)

model.n.griev.hurd.mm <- hurdle(n.events.massmob.post ~ jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag +  osorg.1lag +  natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   gdpgro.1lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre | jucon.1lag + legcon.1lag + gdpgro.1lag + altinf.1lag +  osorg.1lag +  natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   gdpgro.1lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre, dist = "negbin", data = nelda_massmob %>% filter(gdpgro.1lag < 1))
summary(model.n.griev.hurd.mm)


model.n.griev2.hurd.mm <- hurdle(n.events.massmob.post ~ jucon.1lag + legcon.1lag + osorg.1lag + altinf.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   econ.crisis.nelda.1lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre | jucon.1lag + legcon.1lag  + altinf.1lag + osorg.1lag + econ.crisis.nelda.1lag + natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   econ.crisis.nelda.1lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre , data = nelda_massmob, dist = "negbin")
summary(model.n.griev2.hurd.mm)

model.n.griev3.hurd.mm <- hurdle(n.events.massmob.post ~ jucon.1lag + legcon.1lag + altinf.1lag +  pubseccorrup.lag + osorg.1lag +  natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   pubseccorrup.lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre  | jucon.1lag + legcon.1lag + altinf.1lag +  pubseccorrup.lag + osorg.1lag +  natlpartyorg.lag + v2elirreg.inv + pubseccorrup.lag +   pubseccorrup.lag*v2elirreg.inv  + presidential + inc.termlimit.num  +  physinteg.1lag + physintlag.sq + urban.pct + rentierstate + taxstate + n.events.massmob.pre, data = nelda_massmob, dist = "negbin")
summary(model.n.griev3.hurd.mm)
```

```{r n-protests-margin-max, fig.cap="Fraud, incumbent vote-share, and number of protest events", echo=FALSE, message=FALSE, out.width = '70%', fig.align='center'}
dat <- ggpredict(model.n.base2.hurd.mm, terms = c("winner.share.upd", "v2elirreg.inv [-2.3, 3.2]")) 
p.n.margin <- plot(dat)
p.n.margin + coord_cartesian(ylim = c(0, 70)) + labs(x = "Incumbent vote-share", y = "Number of events", title = "Predicted counts of protest events", color = "Election fraud") + theme_bw()

```

```{r n-protests-crisis-max, fig.cap="Fraud, economic crisis, and number of protest events", echo=FALSE, message=FALSE, out.width = '70%', fig.align='center'}
dat <- ggpredict(model.n.griev2.hurd.mm, terms = c("econ.crisis.nelda.1lag", "v2elirreg.inv [-2.3, 3.2]")) 
p.n.crisis <- plot(dat)
p.n.crisis + coord_cartesian(ylim = c(0, 125)) + labs(x = "Economic crisis", y = "Number of events", title = "Predicted counts of protest events", color = "Election fraud") + theme_bw()

```


```{r n-protests-corrupt-max, fig.cap="Fraud, public sector corruption, and number of protest events", echo=FALSE, message=FALSE, out.width = '70%', fig.align='center'}
dat <- ggpredict(model.n.griev3.hurd.mm, terms = c("pubseccorrup.lag", "v2elirreg.inv [-2.3, 3.2]")) 
p.corr.n.margin <- plot(dat)
p.corr.n.margin + coord_cartesian(ylim = c(0, 120)) + labs(x = "Public sector corruption", y = "Number of events", title = "Predicted counts of protest events", color = "Election fraud") + theme_bw()

```


\newpage


# Removing controls to address multicollinearity

The models in the main text include a suite of control variables aimed at controlling for common causes of election manipulation and protest, in order to minimize the risks of confounding and omitted variable bias. However, this approach runs the risk that individual coefficients may be highly sensitive to model specification due to multicollinearity. In particular, many of the control variables\textemdash such as *legislative constraints*, *judicial independence*, and *physical integrity* are likely to be correlated with pre-election protest. To address this risk, the models in Tables \@ref(tab:zero-model-table-small) and \@ref(tab:zero-model-table-count-small) exclude non-electoral control variables. That is, they include variables related to the election itself, the measure of *pre-election protest*, and the explanatory variables from the main models. 

The results echo those from the main text. Severity of election fraud is not associated with an increased number of protests, conditional on incumbent vote-share, economic crisis, or public-sector corruption. Marginal effects for interaction terms are presented in the following figures.

```{r models-hurdlesmall-mm, warning = FALSE, message = FALSE, include = F}
model.small.novoteshare.hurd.mm <- hurdle(n.events.massmob.post ~ v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election |  v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election , data = nelda_massmob %>% filter(gdpgro.1lag < 1), dist = "negbin")
summary(model.small.novoteshare.hurd.mm)

model.small.base.hurd.mm <- hurdle(n.events.massmob.post ~  v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd |  v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd , data = nelda_massmob %>% filter(gdpgro.1lag < 1), dist = "negbin")
summary(model.small.base.hurd.mm)

model.small.base2.hurd.mm <- hurdle(n.events.massmob.post ~  v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd + winner.share.upd*v2elirreg.inv | v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd  + winner.share.upd*v2elirreg.inv, data = nelda_massmob %>% filter(gdpgro.1lag < 1), dist = "negbin")
summary(model.small.base2.hurd.mm)




model.small.griev2.hurd.mm <- hurdle(n.events.massmob.post ~  v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd + econ.crisis.nelda.1lag*v2elirreg.inv | v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd + econ.crisis.nelda.1lag*v2elirreg.inv , data = nelda_massmob, dist = "negbin")
summary(model.small.griev2.hurd.mm)

model.small.griev3.hurd.mm <- hurdle(n.events.massmob.post ~ v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd + pubseccorrup.lag*v2elirreg.inv   |   v2elirreg.inv + presidential + inc.termlimit.num  + n.events.massmob.pre + unscheduled_election + winner.share.upd + pubseccorrup.lag*v2elirreg.inv , data = nelda_massmob, dist = "negbin")
summary(model.small.griev3.hurd.mm)
```
\newpage

```{r zero-model-table-small, echo=FALSE}

models <- list()
models[['Model 11']] <- model.small.base.hurd.mm
models[['Model 12']] <- model.small.base2.hurd.mm
#models[['Model ']] <- model.n.griev.hurd.mm
models[['Model 13']] <- model.small.griev2.hurd.mm
models[['Model 14']] <- model.small.griev3.hurd.mm


modelsummary::modelsummary(models, coef_omit = "count", gof_omit = "R2", stars = T, longtable=T,  title = 'Binary portion of hurdle models of post-election protest', coef_rename = 
               c("zero_(Intercept)" = "Intercept", "zero_presidential1" = "Presidential election",
                 "zero_inc.termlimit.num" = "Incumbent term-limited",  
                                  "zero_n.events.massmob.pre" = "Number of pre-election protests", "zero_pubseccorrup.lag" = "Public sector corruption (lag)", "zero_v2elirreg.inv" = "Election fraud", "zero_unscheduled_election" = "Off-schedule election", "zero_winner.share.upd" = "Incumbent vote-share", "v2elirreg.inv" = "Election fraud", "winner.share.upd" = "Incumbent vote-share",
                 "zero_econ.crisis.nelda.1lag1" = "Economic crisis", "econ.crisis.nelda.1lag1" = "Economic crisis",
                 "pubseccorrup.lag" = "Public sector corruption"))


```

\newpage

```{r zero-model-table-count-small, echo=FALSE}
modelsummary::modelsummary(models, coef_omit = "zero", gof_omit = "R2", longtable=T, stars = T, title = 'Hurdle models of post-election protest (counts)',
                           coef_rename = 
              c("count_(Intercept)" = "Intercept", "count_presidential1" = "Presidential election",
                 "count_inc.termlimit.num" = "Incumbent term-limited",  
                                  "count_n.events.massmob.pre" = "Number of pre-election protests", "count_pubseccorrup.lag" = "Public sector corruption (lag)", "count_v2elirreg.inv" = "Election fraud", "count_unscheduled_election" = "Off-schedule election", "count_winner.share.upd" = "Incumbent vote-share", "v2elirreg.inv" = "Election fraud", "winner.share.upd" = "Incumbent vote-share",
                 "count_econ.crisis.nelda.1lag1" = "Economic crisis", "econ.crisis.nelda.1lag1" = "Economic crisis",
                 "pubseccorrup.lag" = "Public sector corruption"))

```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
dat <- ggpredict(model.small.base2.hurd.mm, terms = c("winner.share.upd", "v2elirreg.inv [-.44, 1.77]")) 
p.n.margin <- plot(dat)
p.n.margin <- p.n.margin + labs(x = "Incumbent vote-share", y = "Predicted number of protests" , title = "Predicted count of protest events") + coord_cartesian(ylim = c(0, 100)) + theme_bw()

dat <- ggpredict(model.small.base2.hurd.mm, terms = c("winner.share.upd", "v2elirreg.inv [-.44, 1.77]"), type = "zi_prob") 
p.b.margin <- plot(dat)
p.b.margin <- p.b.margin + labs(x = "Incumbent vote-share", y = "Predicted probability of protest" , title = "Predicted probability of any protest")  + theme_bw()

```

```{r n-protests-margin-small, fig.cap="Election integrity, incumbent vote-share, and number of protest events", echo=FALSE, warning=FALSE, out.width = '70%', fig.align='center'}
p.n.margin 

```

```{r b-protests-margin-small, fig.cap="Election integrity, incumbent vote-share, and likelihood of protest", echo=FALSE, warning=FALSE, out.width = '70%', fig.align='center'}
p.b.margin 

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
dat <- ggpredict(model.small.griev2.hurd.mm, terms = c("econ.crisis.nelda.1lag", "v2elirreg.inv [-.44, 1.77]")) 
p.n.crisis <- plot(dat)
p.n.crisis <- p.n.crisis + labs(x = "Economic crisis", y = "Predicted number of protests" , title = "Predicted count of protest events") + theme_bw()

dat <- ggpredict(model.small.griev2.hurd.mm, terms = c("econ.crisis.nelda.1lag", "v2elirreg.inv [-.44, 1.77]"), type = "zi_prob") 
p.b.crisis <- plot(dat)
p.b.crisis <- p.b.crisis + labs(x = "Economic crisis", y = "Predicted probability of protest" , title = "Predicted probability of any protest") +  theme_bw()

```


```{r n-protests-crisis-small, fig.cap="Election integrity, economic crisis, and number of protest events", echo=FALSE, warning=FALSE, out.width = '70%', fig.align='center'}
p.n.crisis
```

```{r b-protests-crisis-small, fig.cap="Election integrity, economic crisis, and likelihood of protest", warning = FALSE, echo=FALSE, out.width = '70%', fig.align='center'}
p.b.crisis
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
dat <- ggpredict(model.small.griev3.hurd.mm, terms = c("pubseccorrup.lag", "v2elirreg.inv [-.44, 1.77]")) 
p.corr.n.margin <- plot(dat)
p.corr.n.margin <- p.corr.n.margin + coord_cartesian(ylim = c(0, 100)) + labs(x = "Public sector corruption", y = "Predicted number of protests" , title = "Predicted count of protest events") + theme_bw()


dat <- ggpredict(model.small.griev3.hurd.mm, terms = c("pubseccorrup.lag", "v2elirreg.inv [-.44, 1.77]"), type = "zi_prob") 
p.corr.b.margin <- plot(dat)
p.corr.b.margin <- p.corr.b.margin + labs(x = "Public sector corruption", y = "Predicted probability of protest" , title = "Predicted probability of any protest") + theme_bw()

```

```{r n-protests-corrupt-small, fig.cap="Election integrity, public sector corruption, and number of protest events", echo=FALSE, warning=FALSE, out.width = '70%', fig.align='center'}
p.corr.n.margin
```

```{r b-protests-corrupt-small, fig.cap="Election integrity, public sector corruption, and likelihood of protest", echo=FALSE, warning=FALSE, out.width = '70%', fig.align='center'}
p.corr.b.margin
```



\newpage

# References

